{% extends "base.html" %}

{% block title %}Connexion Â· CRM Local{% endblock %}
{% block page_eyebrow %}AccÃ¨s sÃ©curisÃ©{% endblock %}
{% block page_title %}Connexion{% endblock %}
{% block page_subtitle %}Saisissez vos identifiants internes pour accÃ©der au CRM.{% endblock %}

{% block content %}
  <div class="mx-auto max-w-lg space-y-6">
    {% if current_user or already_authenticated %}
      <div class="space-y-4 rounded-3xl border border-emerald-300/70 bg-emerald-50/80 p-6 text-sm text-emerald-800 shadow-sm dark:border-emerald-400/40 dark:bg-emerald-500/10 dark:text-emerald-100">
        <p class="text-base font-semibold">
          {% if current_user %}
            Vous Ãªtes connectÃ© en tant que {{ current_user.username }}.
          {% else %}
            Vous Ãªtes actuellement connectÃ©.
          {% endif %}
        </p>
        <p>Utilisez le bouton ci-dessous pour vous dÃ©connecter et permettre une nouvelle connexion.</p>
        <form method="post" action="/logout" class="flex flex-wrap items-center gap-3">
          <input type="hidden" name="redirect_to" value="{{ next or '/login' }}">
          <button
            type="submit"
            class="inline-flex items-center gap-2 rounded-2xl border border-rose-300 bg-rose-500/90 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-rose-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-rose-200 dark:border-rose-400/60 dark:bg-rose-500/70"
          >
            <span aria-hidden="true">ğŸšª</span>
            Se dÃ©connecter
          </button>
        </form>
      </div>
    {% endif %}
    {% if error %}
      <div class="rounded-2xl border border-rose-300/70 bg-rose-50/80 p-4 text-sm text-rose-700 shadow-sm dark:border-rose-400/40 dark:bg-rose-500/10 dark:text-rose-100">
        {{ error }}
      </div>
    {% endif %}
    <form method="post" action="/login" class="space-y-5 rounded-3xl border border-slate-200 bg-white p-8 shadow-xl shadow-indigo-500/10 dark:border-white/10 dark:bg-white/5 dark:shadow-indigo-500/20">
      <div class="space-y-2">
        <label for="username" class="block text-sm font-semibold uppercase tracking-[0.3em] text-slate-500 dark:text-slate-300">Identifiant</label>
        <input
          id="username"
          name="username"
          type="text"
          value="{{ username or '' }}"
          required
          autofocus
          class="w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-base text-slate-900 shadow-sm transition focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-400 dark:border-white/10 dark:bg-white/5 dark:text-white"
        >
      </div>
      <div class="space-y-2">
        <label for="password" class="block text-sm font-semibold uppercase tracking-[0.3em] text-slate-500 dark:text-slate-300">Mot de passe</label>
        <input
          id="password"
          name="password"
          type="password"
          required
          class="w-full rounded-2xl border border-slate-200 bg-white px-4 py-3 text-base text-slate-900 shadow-sm transition focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-400 dark:border-white/10 dark:bg-white/5 dark:text-white"
        >
      </div>
      <input type="hidden" name="next" value="{{ next or '' }}">
      <button
        type="submit"
        class="inline-flex w-full items-center justify-center gap-2 rounded-2xl border border-indigo-400 bg-indigo-500/90 px-4 py-3 text-base font-semibold text-white shadow shadow-indigo-500/30 transition hover:bg-indigo-500 focus:outline-none focus-visible:ring-2 focus-visible:ring-indigo-300 dark:border-indigo-400/40 dark:bg-indigo-500/80"
      >
        <span aria-hidden="true">ğŸ”“</span>
        Se connecter
      </button>
    </form>
  </div>
{% endblock %}
