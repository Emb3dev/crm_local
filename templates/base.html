<!doctype html>
<html lang="fr" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}CRM Local{% endblock %}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/styles.css" />
  <script src="https://unpkg.com/htmx.org@2.0.2"></script>
</head>
<body>
  <a class="skip-link" href="#main">Aller au contenu</a>
  <div class="app-shell">
    <button id="themeToggle" class="theme-toggle" title="Basculer le thÃ¨me" aria-label="Basculer le thÃ¨me">
      <span aria-hidden="true">ðŸŒ™</span>
    </button>

    <main id="main" class="{% block main_classes %}app-shell__surface{% endblock %}" tabindex="-1">
      <div class="page-heading">
        <span class="page-heading__badge">CRM Local</span>
        <div class="page-heading__eyebrow">{% block page_eyebrow %}Portail Ã©quipes service client{% endblock %}</div>
        <h1 class="page-heading__title">{% block page_title %}Votre environnement opÃ©rationnel{% endblock %}</h1>
        <p class="page-heading__subtitle">{% block page_subtitle %}Visualisez, importez et mettez Ã  jour votre portefeuille client avec une interface intuitive et performante.{% endblock %}</p>
      </div>
      {% block content %}{% endblock %}
    </main>
  </div>

  <script>
    const root = document.documentElement;
    const btn = document.getElementById('themeToggle');
    const saved = localStorage.getItem('theme');
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    const initialTheme = saved || (prefersDark ? 'dark' : 'light');
    root.setAttribute('data-theme', initialTheme);
    updateToggleIcon(initialTheme);

    btn?.addEventListener('click', () => {
      const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
      updateToggleIcon(next);
    });

    function updateToggleIcon(theme) {
      if (!btn) return;
      btn.innerHTML = theme === 'dark' ? '<span aria-hidden="true">ðŸŒž</span>' : '<span aria-hidden="true">ðŸŒ™</span>';
    }
  </script>
</body>
</html>
